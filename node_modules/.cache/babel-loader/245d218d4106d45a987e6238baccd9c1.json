{"ast":null,"code":"import io from\"socket.io-client\";import{setPendingFriendsInvitations,setFriends,setOnlineUsers}from\"../store/actions/friendsActions\";import store from\"../store/store\";import{updateDirectChatHistoryIfActive}from\"../shared/utils/chat\";import*as roomHandler from\"./roomHandler\";import*as webRTCHandler from\"./webRTCHandler\";let socket=null;export const connectWithSocketServer=userDetails=>{const jwtToken=userDetails.token;socket=io(\"http://localhost:5002\",{auth:{token:jwtToken}});socket.on(\"connect\",()=>{console.log(\"succesfully connected with socket.io server\");console.log(socket.id);});socket.on(\"friends-invitations\",data=>{const{pendingInvitations}=data;store.dispatch(setPendingFriendsInvitations(pendingInvitations));});socket.on(\"friends-list\",data=>{const{friends}=data;store.dispatch(setFriends(friends));});socket.on(\"online-users\",data=>{const{onlineUsers}=data;store.dispatch(setOnlineUsers(onlineUsers));});socket.on(\"direct-chat-history\",data=>{console.log(data);updateDirectChatHistoryIfActive(data);});socket.on(\"room-create\",data=>{roomHandler.newRoomCreated(data);});socket.on(\"active-rooms\",data=>{roomHandler.updateActiveRooms(data);});socket.on(\"conn-prepare\",data=>{const{connUserSocketId}=data;webRTCHandler.prepareNewPeerConnection(connUserSocketId,false);socket.emit(\"conn-init\",{connUserSocketId:connUserSocketId});});socket.on(\"conn-init\",data=>{const{connUserSocketId}=data;webRTCHandler.prepareNewPeerConnection(connUserSocketId,true);});socket.on(\"conn-signal\",data=>{webRTCHandler.handleSignalingData(data);});socket.on(\"room-participant-left\",data=>{console.log(\"user left room\");webRTCHandler.handleParticipantLeftRoom(data);});};export const sendDirectMessage=data=>{console.log(data);socket.emit(\"direct-message\",data);};export const getDirectChatHistory=data=>{socket.emit(\"direct-chat-history\",data);};export const createNewRoom=()=>{socket.emit(\"room-create\");};export const joinRoom=data=>{socket.emit(\"room-join\",data);};export const leaveRoom=data=>{socket.emit(\"room-leave\",data);};export const signalPeerData=data=>{socket.emit(\"conn-signal\",data);};","map":{"version":3,"names":["io","setPendingFriendsInvitations","setFriends","setOnlineUsers","store","updateDirectChatHistoryIfActive","roomHandler","webRTCHandler","socket","connectWithSocketServer","userDetails","jwtToken","token","auth","on","console","log","id","data","pendingInvitations","dispatch","friends","onlineUsers","newRoomCreated","updateActiveRooms","connUserSocketId","prepareNewPeerConnection","emit","handleSignalingData","handleParticipantLeftRoom","sendDirectMessage","getDirectChatHistory","createNewRoom","joinRoom","leaveRoom","signalPeerData"],"sources":["/home/sameeramp/Videos/Zync-Frontend/src/realtimeCommunication/socketConnection.js"],"sourcesContent":["import io from \"socket.io-client\";\r\nimport {\r\n  setPendingFriendsInvitations,\r\n  setFriends,\r\n  setOnlineUsers,\r\n} from \"../store/actions/friendsActions\";\r\nimport store from \"../store/store\";\r\nimport { updateDirectChatHistoryIfActive } from \"../shared/utils/chat\";\r\nimport * as roomHandler from \"./roomHandler\";\r\nimport * as webRTCHandler from \"./webRTCHandler\";\r\n\r\nlet socket = null;\r\n\r\nexport const connectWithSocketServer = (userDetails) => {\r\n  const jwtToken = userDetails.token;\r\n\r\n  socket = io(\"http://localhost:5002\", {\r\n    auth: {\r\n      token: jwtToken,\r\n    },\r\n  });\r\n\r\n  socket.on(\"connect\", () => {\r\n    console.log(\"succesfully connected with socket.io server\");\r\n    console.log(socket.id);\r\n  });\r\n\r\n  socket.on(\"friends-invitations\", (data) => {\r\n    const { pendingInvitations } = data;\r\n    store.dispatch(setPendingFriendsInvitations(pendingInvitations));\r\n  });\r\n\r\n  socket.on(\"friends-list\", (data) => {\r\n    const { friends } = data;\r\n    store.dispatch(setFriends(friends));\r\n  });\r\n\r\n  socket.on(\"online-users\", (data) => {\r\n    const { onlineUsers } = data;\r\n    store.dispatch(setOnlineUsers(onlineUsers));\r\n  });\r\n\r\n  socket.on(\"direct-chat-history\", (data) => {\r\n    console.log(data);\r\n    updateDirectChatHistoryIfActive(data);\r\n  });\r\n\r\n  socket.on(\"room-create\", (data) => {\r\n    roomHandler.newRoomCreated(data);\r\n  });\r\n\r\n  socket.on(\"active-rooms\", (data) => {\r\n    roomHandler.updateActiveRooms(data);\r\n  });\r\n\r\n  socket.on(\"conn-prepare\", (data) => {\r\n    const { connUserSocketId } = data;\r\n    webRTCHandler.prepareNewPeerConnection(connUserSocketId, false);\r\n    socket.emit(\"conn-init\", { connUserSocketId: connUserSocketId });\r\n  });\r\n\r\n  socket.on(\"conn-init\", (data) => {\r\n    const { connUserSocketId } = data;\r\n    webRTCHandler.prepareNewPeerConnection(connUserSocketId, true);\r\n  });\r\n\r\n  socket.on(\"conn-signal\", (data) => {\r\n    webRTCHandler.handleSignalingData(data);\r\n  });\r\n\r\n  socket.on(\"room-participant-left\", (data) => {\r\n    console.log(\"user left room\");\r\n    webRTCHandler.handleParticipantLeftRoom(data);\r\n  });\r\n};\r\n\r\nexport const sendDirectMessage = (data) => {\r\n  console.log(data);\r\n  socket.emit(\"direct-message\", data);\r\n};\r\n\r\nexport const getDirectChatHistory = (data) => {\r\n  socket.emit(\"direct-chat-history\", data);\r\n};\r\n\r\nexport const createNewRoom = () => {\r\n  socket.emit(\"room-create\");\r\n};\r\n\r\nexport const joinRoom = (data) => {\r\n  socket.emit(\"room-join\", data);\r\n};\r\n\r\nexport const leaveRoom = (data) => {\r\n  socket.emit(\"room-leave\", data);\r\n};\r\n\r\nexport const signalPeerData = (data) => {\r\n  socket.emit(\"conn-signal\", data);\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}